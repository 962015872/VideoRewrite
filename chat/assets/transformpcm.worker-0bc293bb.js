(function(){"use strict";self.onmessage=function(r){switch(r.data.command){case"transform":s.transaction(r.data.buffer);break}};var s={transaction(r){let a=s.to16kHz(r),t=s.to16BitPCM(a);self.postMessage({buffer:t})},to16kHz(r){var a=new Float32Array(r),t=Math.round(a.length*(16e3/44100)),e=new Float32Array(t),n=(a.length-1)/(t-1);e[0]=a[0];for(let v=1;v<t-1;v++){var o=v*n,f=Math.floor(o).toFixed(),i=Math.ceil(o).toFixed(),l=o-f;e[v]=a[f]+(a[i]-a[f])*l}return e[t-1]=a[a.length-1],e},to16BitPCM(r){for(var a=r.length*2,t=new ArrayBuffer(a),e=new DataView(t),n=0,o=0;o<r.length;o++,n+=2){var f=Math.max(-1,Math.min(1,r[o]));e.setInt16(n,f<0?f*32768:f*32767,!0)}return Array.from(new Int8Array(e.buffer))},toBase64(r){for(var a="",t=new Uint8Array(r),e=t.byteLength,n=0;n<e;n++)a+=String.fromCharCode(t[n]);return window.btoa(a)}}})();
